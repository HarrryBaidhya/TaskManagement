@model IEnumerable<TaskManagement.Models.ProductModel>

@{
    Layout = "_Layout";
}

<h2 class="mt-3 mb-4">Product List</h2>

<!-- 🔍 Search & Export Form -->
<form method="get" asp-action="ProductDetail">
    <div class="row mb-3 align-items-end">
        <div class="col-md-3">
            <label for="searchDate" class="form-label">Filter by Date</label>
            <input type="date" id="searchDate" name="searchDate" class="form-control" value="@ViewBag.SearchDate" />
        </div>

        <div class="col-md-2">
            <button type="submit" class="btn btn-primary w-100">Search</button>
        </div>

        <div class="col-md-2">
            <a asp-action="ProductDetail" class="btn btn-secondary w-100">Reset</a>
        </div>

        <div class="col-md-2">
            <a asp-action="ExportToExcel" asp-route-searchDate="@ViewBag.SearchDate" class="btn btn-success w-100">Export Excel</a>
        </div>

        <div class="col-md-2">
            <a asp-action="ExportToPdf" asp-route-searchDate="@ViewBag.SearchDate" class="btn btn-danger w-100">Export PDF</a>
        </div>

        
        <div class="col-md-2">
            <a asp-action="AddProduct" class="btn btn-primary w-100">Add</a>
        </div>
    </div>
</form>

<!-- 📋 Product Table -->
<table class="table table-striped table-bordered">
    <thead class="table-dark">
        <tr>
            <th>@Html.DisplayNameFor(model => model.First().ProductID)</th>
            <th>@Html.DisplayNameFor(model => model.First().ProductName)</th>
            <th>@Html.DisplayNameFor(model => model.First().Category)</th>
            <th>@Html.DisplayNameFor(model => model.First().Price)</th>
            <th>@Html.DisplayNameFor(model => model.First().StockQuantity)</th>
            <th>@Html.DisplayNameFor(model => model.First().CreatedDate)</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        @if (Model != null && Model.Any())
        {
            foreach (var item in Model)
            {
                <tr>
                    <td>@item.ProductID</td>
                    <td>@item.ProductName</td>
                    <td>@item.Category</td>
                    <td>@item.Price.ToString("0.00")</td>
                    <td>@item.StockQuantity</td>
                    <td>@item.CreatedDate</td>
                    <td>
                        <!-- ✏️ Update button -->
                        <a asp-action="EditOrder"
                           asp-route-id="@item.ProductID"
                           class="btn btn-sm btn-warning">
                            <i class="fas fa-edit"></i> Edit
                        </a>

                        <!-- 🗑️ Delete button -->
                        <a asp-action="DeleteOrder"
                           asp-route-id="@item.ProductID"
                           class="btn btn-sm btn-danger"
                           onclick="return confirm('Are you sure you want to delete this order?');">
                            <i class="fas fa-trash"></i> Delete
                        </a>
                    </td>
                </tr>
            }
        }
        else
        {
            <tr>
                <td colspan="6" class="text-center text-muted">No products found.</td>
            </tr>
        }
    </tbody>
</table>

<!-- 📄 Pagination Controls -->
<nav aria-label="Product pagination">
    <ul class="pagination justify-content-center mt-3">
        <li class="page-item @(ViewBag.PageNumber <= 1 ? "disabled" : "")">
            <a class="page-link"
               asp-action="ProductDetail"
               asp-route-pageNumber="@(ViewBag.PageNumber - 1)"
               asp-route-searchDate="@ViewBag.SearchDate">Previous</a>
        </li>

        <li class="page-item">
            <a class="page-link"
               asp-action="ProductDetail"
               asp-route-pageNumber="@(ViewBag.PageNumber + 1)"
               asp-route-searchDate="@ViewBag.SearchDate">Next</a>
        </li>
    </ul>
</nav>
